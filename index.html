<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Knowledge Hub — Learn. Grow. Build.</title>

<!-- SEO -->
<meta name="description" content="Knowledge Hub — concise, practical guides and deep breakdowns. Updated automatically." />
<link rel="icon" href="/favicon.ico" />

<!-- Google verification & Analytics if present (kept minimal) -->
<meta name="google-site-verification" content="74ovZZU1fP4AXZgVnj2dhMMto-HK7rL7No0LGAMcue4" />

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">

<!-- Minimal CSS (responsive, premium cards) -->
<style>
:root{
  --bg:#ffffff; --surface:#f8f9fb; --muted:#6b7280; --accent:#1a73e8; --card:#ffffff;
  --radius:12px; --glass: rgba(255,255,255,0.6);
  --maxw:1100px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{font-family:"Inter",system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:linear-gradient(180deg,#fbfdff,#f6f9fc); color:#0f1724; -webkit-font-smoothing:antialiased}
.site{max-width:var(--maxw); margin:28px auto; padding:20px}
.header{display:flex;align-items:center;gap:16px;justify-content:space-between}
.brand{display:flex;align-items:center;gap:12px}
.logo{
  width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,#0ea5e9,#7c3aed);display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:20px;
  box-shadow: 0 6px 20px rgba(16,24,40,0.08);
}
.h1{font-weight:700;font-size:20px}
.controls{display:flex;gap:12px;align-items:center}
.search{padding:10px 12px;border-radius:10px;border:1px solid #e6eef7;min-width:220px;outline:none}
.filter-btn{background:none;border:1px solid #e6eef7;padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer}
.hero{background:linear-gradient(90deg,rgba(122,91,255,0.08),rgba(26,115,232,0.04));border-radius:14px;padding:18px;margin-top:18px;display:flex;gap:18px;align-items:center;justify-content:space-between}
.hero .left{max-width:70%}
.hero h2{margin:0;font-size:20px}
.hero p{margin:6px 0 0;color:var(--muted)}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:22px}
.card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(15,23,42,0.04);min-height:120px;display:flex;flex-direction:column;justify-content:space-between}
.card h3{margin:0 0 8px;font-size:16px}
.meta{font-size:13px;color:var(--muted);display:flex;gap:10px;align-items:center}
.cta{display:inline-block;padding:8px 12px;background:var(--accent);color:#fff;border-radius:10px;text-decoration:none;font-weight:600}
.footer{margin:36px 0 120px;color:var(--muted);font-size:13px;text-align:center}

/* responsive */
@media (max-width:1000px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:640px){.grid{grid-template-columns:1fr}.hero{flex-direction:column;align-items:flex-start}.search{min-width:100%}}
</style>
</head>
<body>
<div class="site">
  <header class="header">
    <div class="brand">
      <div class="logo">KH</div>
      <div>
        <div class="h1">Knowledge Hub</div>
        <div style="color:var(--muted);font-size:13px">Practical guides • Auto-generated • Human-reviewed</div>
      </div>
    </div>

    <div class="controls">
      <input id="searchInput" class="search" placeholder="Search articles (title / keyword) ..." />
      <button id="refreshBtn" class="filter-btn">Refresh</button>
    </div>
  </header>

  <div class="hero" role="region" aria-label="hero">
    <div class="left">
      <h2>Daily knowledge, built for action</h2>
      <p>Auto-generated posts from high-quality building blocks. Click any post to read — includes reading-time, affiliate CTA zones, and internal suggestions.</p>
    </div>
    <div>
      <a href="#" id="createPostQuick" class="cta">Generate demo post ▶</a>
    </div>
  </div>

  <section>
    <h3 style="margin:18px 0 8px">Latest articles</h3>
    <div id="count" style="color:var(--muted);font-size:13px">Loading…</div>
    <div id="cards" class="grid" style="margin-top:12px"></div>
  </section>

  <div class="footer">© Knowledge Hub — Auto-pilot content engine • Built for testing & templates</div>
</div>

<!-- Marked for client-side md to html -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
/* Utility: fetch directory listing (GitHub Pages exposes index if browsable) */
async function listPosts() {
  // attempt to fetch /posts/ directory (depends on GitHub Pages listing)
  try {
    const res = await fetch('posts/');
    if (!res.ok) return [];
    const text = await res.text();
    // parse href to .md files
    const matches = [...text.matchAll(/href="([^"]+\.md)"/g)].map(m => m[1]);
    // sort newest-first (filename starts with date)
    return matches.sort().reverse();
  } catch(e){
    console.error(e);
    return [];
  }
}

function shortTitleFromFilename(fn){
  return fn.replace(/^\d{4}-\d{2}-\d{2}-/,'').replace(/\.md$/,'').replace(/-/g,' ').replace(/\s+/g,' ').trim();
}

function formatMeta(dateStr){
  try{ const d = new Date(dateStr); return d.toLocaleDateString(); }catch(e){ return dateStr }
}

function renderCard(file){
  const title = shortTitleFromFilename(file);
  const slug = encodeURIComponent(`posts/${file}`);
  return `
  <a class="card" href="post.html?file=${slug}">
    <div>
      <h3>${title}</h3>
      <div class="meta"> <span>Auto • Demo</span> • <span>${formatMeta(file.slice(0,10))}</span> </div>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
      <div style="color:var(--muted);font-size:13px">reading • <span class="rt">—</span></div>
      <div><span class="cta" style="padding:8px 10px;font-size:13px">Read</span></div>
    </div>
  </a>`;
}

async function populate() {
  const list = await listPosts();
  const container = document.getElementById('cards');
  const count = document.getElementById('count');
  container.innerHTML = '';
  count.textContent = `${list.length} posts`;
  if(list.length===0){
    container.innerHTML = `<div style="grid-column:1/-1;color:var(--muted);padding:24px;background:#fff;border-radius:10px;text-align:center">No posts found — generate demo or push posts to <code>/posts</code></div>`;
    return;
  }
  // only show latest 30
  const toShow = list.slice(0,30);
  container.innerHTML = toShow.map(f => renderCard(f)).join('');
}

document.getElementById('refreshBtn').addEventListener('click',populate);
document.getElementById('createPostQuick').addEventListener('click', async (e)=>{
  e.preventDefault();
  alert('Demo generator triggered — use your CI or Actions to generate real posts.');
});

document.getElementById('searchInput').addEventListener('input', async (e)=>{
  const q = e.target.value.trim().toLowerCase();
  const list = await listPosts();
  const filtered = list.filter(f => f.toLowerCase().includes(q));
  const container = document.getElementById('cards');
  container.innerHTML = filtered.slice(0,60).map(f => renderCard(f)).join('') || '<div style="grid-column:1/-1;color:var(--muted);padding:18px">No results</div>';
  document.getElementById('count').textContent = `${filtered.length} posts`;
});

populate();
</script>
</body>
</html>
