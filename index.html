<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Knowledge Hub — Latest Articles</title>
<meta name="description" content="Knowledge Hub — practical guides and tutorials. Browse latest articles." />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
<style>
:root{
  --accent:#1a73e8;--muted:#6b7280;--bg:#fff;--card:#ffffff;--glass: rgba(15,23,36,0.03)
}
*{box-sizing:border-box}
body{font-family:"Inter",system-ui,Arial;background:var(--bg);margin:0;color:#0f1724}
.container{max-width:1100px;margin:30px auto;padding:20px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#0ea5e9,#7c3aed);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
.h1{font-family:"Merriweather",serif;font-size:22px;font-weight:700}
.controls{display:flex;gap:10px;align-items:center}
.search{padding:10px 12px;border-radius:10px;border:1px solid #e6eefc;width:320px}
.category{padding:8px 10px;border-radius:999px;border:1px solid #eef5ff;background:#fbfdff;color:var(--accent);font-weight:600;cursor:pointer}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:14px;margin-top:18px}
.card{background:var(--card);border-radius:12px;padding:14px;border:1px solid #eef2f6;box-shadow:0 6px 18px rgba(12,23,44,0.03)}
.card h3{margin:0 0 8px 0;font-size:18px}
.card .meta{font-size:13px;color:var(--muted);margin-bottom:8px;display:flex;gap:8px}
.card p{margin:0;color:#24303a}
.pager{display:flex;gap:10px;justify-content:center;margin:28px 0}
.btn{padding:10px 14px;border-radius:10px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
.small{font-size:13px;color:var(--muted)}
.empty{padding:40px;text-align:center;color:var(--muted)}
@media (max-width:720px){.search{width:160px}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="brand">
      <div class="logo">KH</div>
      <div>
        <div class="h1">Knowledge Hub</div>
        <div class="small">Quick, practical, tested — Latest</div>
      </div>
    </div>
    <div class="controls">
      <input id="searchInput" placeholder="Search by keyword or title..." class="search" />
      <div id="categoriesWrap"></div>
    </div>
  </div>

  <div id="cardsGrid" class="grid"></div>
  <div id="empty" class="empty" style="display:none">No articles found.</div>
  <div class="pager">
    <button id="prevBtn" class="btn" style="background:#eef2f6;color:#0b1220">Prev</button>
    <div id="pageInfo" class="small">Page 1</div>
    <button id="nextBtn" class="btn">Next</button>
  </div>
</div>

<script>
/* Simple client-side index that reads listing of posts/ (generated by GitHub) */
const PAGE_SIZE = 12;
let allFiles = []; // array of {file,title,date,tags}
let filtered = [];
let page = 1;

function niceTitleFromFilename(fn){
  return fn.replace(/^\d{4}-\d{2}-\d{2}-/,'').replace(/\.md$/,'').replace(/-/g,' ');
}

async function loadListing(){
  // fetch directory listing HTML (GitHub directory view) and extract .md links
  const res = await fetch('posts/');
  const text = await res.text();
  const files = [...text.matchAll(/href="([^"]+\.md)"/g)].map(m=>m[1]);
  allFiles = files.map(f => {
    const fname = f.split('/').pop();
    const date = fname.slice(0,10);
    return {file:f, title:niceTitleFromFilename(fname), date, tags:[]};
  }).reverse();
  // Try to fetch front-matter for tags for first N (optional)
  for(let i=0;i<allFiles.length;i++){
    // skip to keep speed; tags can be populated later
  }
  filtered = allFiles.slice();
  render();
  buildCategories();
}

function render(){
  const grid = document.getElementById('cardsGrid');
  grid.innerHTML = '';
  const start = (page-1)*PAGE_SIZE;
  const pageFiles = filtered.slice(start, start+PAGE_SIZE);
  if(pageFiles.length===0){
    document.getElementById('empty').style.display='block';
  } else {
    document.getElementById('empty').style.display='none';
  }
  pageFiles.forEach(p=>{
    const div = document.createElement('div');
    div.className='card';
    div.innerHTML = `
      <h3><a href="post.html?file=${encodeURIComponent(p.file)}" style="color:inherit;text-decoration:none">${p.title}</a></h3>
      <div class="meta"><div>${new Date(p.date).toLocaleDateString()}</div><div>${p.tags.join(', ')}</div></div>
      <p class="excerpt">Auto-generated practical guide — click to read full article.</p>
    `;
    grid.appendChild(div);
  });
  document.getElementById('pageInfo').textContent = `Page ${page} / ${Math.max(1, Math.ceil(filtered.length/PAGE_SIZE))}`;
}

function buildCategories(){
  // derive simple categories from tags or first word
  const wrap = document.getElementById('categoriesWrap');
  const set = new Set();
  allFiles.forEach(f => {
    const first = f.title.split(' ')[0];
    if(first) set.add(first.toLowerCase());
  });
  const categories = Array.from(set).slice(0,8);
  wrap.innerHTML = '';
  categories.forEach(c=>{
    const btn = document.createElement('div');
    btn.className='category';
    btn.textContent = c;
    btn.onclick = ()=>{ applyCategory(c); };
    wrap.appendChild(btn);
  });
  // add "All"
  const allBtn = document.createElement('div');
  allBtn.className='category';
  allBtn.style.background='#fff';
  allBtn.style.border='1px solid #ddd';
  allBtn.textContent='All';
  allBtn.onclick = ()=>{ resetFilter(); };
  wrap.insertBefore(allBtn, wrap.firstChild);
}

function applyCategory(cat){
  filtered = allFiles.filter(f=> f.title.toLowerCase().startsWith(cat));
  page = 1;
  render();
}
function resetFilter(){ filtered = allFiles.slice(); page=1; render(); }

document.getElementById('nextBtn').onclick = ()=>{ if(page*PAGE_SIZE < filtered.length) { page++; render(); } }
document.getElementById('prevBtn').onclick = ()=>{ if(page>1){ page--; render(); } }
document.getElementById('searchInput').addEventListener('input', e=>{
  const q = e.target.value.trim().toLowerCase();
  filtered = allFiles.filter(f => f.title.toLowerCase().includes(q));
  page = 1; render();
});

loadListing();
</script>
</body>
</html>
